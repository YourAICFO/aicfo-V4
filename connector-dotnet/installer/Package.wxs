<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://wixtoolset.org/schemas/v4/wxs">
  <Package Name="AI CFO Connector" Manufacturer="AI CFO" Version="1.0.0" UpgradeCode="f72aaf9d-f8cf-49de-b380-89df3af861bf" Language="1033">
    <MajorUpgrade DowngradeErrorMessage="A newer version of AI CFO Connector is already installed." />
    <MediaTemplate EmbedCab="yes" />

    <StandardDirectory Id="ProgramFiles64Folder">
      <Directory Id="INSTALLFOLDER" Name="AICFOConnector">
        <Component Id="ServiceExeComponent" Guid="*">
          <File Id="ServiceExe" Source="$(var.ServicePublishDir)\AICFO.Connector.Service.exe" KeyPath="yes" />
          <ServiceInstall Id="ConnectorServiceInstall"
                          Name="AICFO Connector Service"
                          DisplayName="AICFO Connector Service"
                          Description="Syncs Tally accounting data to AI CFO backend"
                          Type="ownProcess"
                          Start="auto"
                          ErrorControl="normal"
                          Account="LocalSystem" />
          <ServiceControl Id="ConnectorServiceControl"
                          Name="AICFO Connector Service"
                          Start="install"
                          Stop="both"
                          Remove="uninstall"
                          Wait="yes" />
        </Component>

        <Component Id="TrayExeComponent" Guid="*">
          <File Id="TrayExe" Source="$(var.TrayPublishDir)\AICFO.Connector.Tray.exe" KeyPath="yes" />
        </Component>
      </Directory>
    </StandardDirectory>

    <StandardDirectory Id="CommonAppDataFolder">
      <Directory Id="ProgramDataAICFO" Name="AICFO">
        <Directory Id="ProgramDataConfig" Name="config" />
        <Directory Id="ProgramDataLogs" Name="logs" />
      </Directory>
    </StandardDirectory>

    <Feature Id="MainFeature" Title="AI CFO Connector" Level="1">
      <ComponentRef Id="ServiceExeComponent" />
      <ComponentRef Id="TrayExeComponent" />
    </Feature>
  </Package>
</Wix>
